%% in this script we try to simplify the matrix, removing all the 10^-14
% terms manually
syms q2 q3 q4 q5
% M = [[ 29.8384*cos(q2) + 23.6212*cos(q3) + 0.876015*cos(q5) + 23.6212*cos(q2)*cos(q3) + 3.2404*cos(q3)*cos(q4) - 23.6212*sin(q2)*sin(q3) - 3.2404*sin(q3)*sin(q4) + 3.2404*cos(q2)*cos(q3)*cos(q4) + 0.876015*cos(q3)*cos(q4)*cos(q5) - 3.2404*cos(q2)*sin(q3)*sin(q4) - 3.2404*cos(q3)*sin(q2)*sin(q4) - 3.2404*cos(q4)*sin(q2)*sin(q3) - 0.876015*cos(q3)*sin(q4)*sin(q5) - 0.876015*cos(q4)*sin(q3)*sin(q5) - 0.876015*cos(q5)*sin(q3)*sin(q4) + 0.876015*cos(q2)*cos(q3)*cos(q4)*cos(q5) - 0.876015*cos(q2)*cos(q3)*sin(q4)*sin(q5) - 0.876015*cos(q2)*cos(q4)*sin(q3)*sin(q5) - 0.876015*cos(q2)*cos(q5)*sin(q3)*sin(q4) - 0.876015*cos(q3)*cos(q4)*sin(q2)*sin(q5) - 0.876015*cos(q3)*cos(q5)*sin(q2)*sin(q4) - 0.876015*cos(q4)*cos(q5)*sin(q2)*sin(q3) + 0.876015*sin(q2)*sin(q3)*sin(q4)*sin(q5) + 48.0381, 14.9192*cos(q2) + 23.6212*cos(q3) + 0.876015*cos(q5) + 11.8106*cos(q2)*cos(q3) + 3.2404*cos(q3)*cos(q4) - 11.8106*sin(q2)*sin(q3) - 3.2404*sin(q3)*sin(q4) + 1.6202*cos(q2)*cos(q3)*cos(q4) + 0.876015*cos(q3)*cos(q4)*cos(q5) - 1.6202*cos(q2)*sin(q3)*sin(q4) - 1.6202*cos(q3)*sin(q2)*sin(q4) - 1.6202*cos(q4)*sin(q2)*sin(q3) - 0.876015*cos(q3)*sin(q4)*sin(q5) - 0.876015*cos(q4)*sin(q3)*sin(q5) - 0.876015*cos(q5)*sin(q3)*sin(q4) + 0.438007*cos(q2)*cos(q3)*cos(q4)*cos(q5) - 0.438007*cos(q2)*cos(q3)*sin(q4)*sin(q5) - 0.438007*cos(q2)*cos(q4)*sin(q3)*sin(q5) - 0.438007*cos(q2)*cos(q5)*sin(q3)*sin(q4) - 0.438007*cos(q3)*cos(q4)*sin(q2)*sin(q5) - 0.438007*cos(q3)*cos(q5)*sin(q2)*sin(q4) - 0.438007*cos(q4)*cos(q5)*sin(q2)*sin(q3) + 0.438007*sin(q2)*sin(q3)*sin(q4)*sin(q5) + 32.0827, 11.8106*cos(q3) + 0.876015*cos(q5) + 11.8106*cos(q2)*cos(q3) + 1.6202*cos(q3)*cos(q4) - 11.8106*sin(q2)*sin(q3) - 1.6202*sin(q3)*sin(q4) + 1.6202*cos(q2)*cos(q3)*cos(q4) + 0.438007*cos(q3)*cos(q4)*cos(q5) - 1.6202*cos(q2)*sin(q3)*sin(q4) - 1.6202*cos(q3)*sin(q2)*sin(q4) - 1.6202*cos(q4)*sin(q2)*sin(q3) - 0.438007*cos(q3)*sin(q4)*sin(q5) - 0.438007*cos(q4)*sin(q3)*sin(q5) - 0.438007*cos(q5)*sin(q3)*sin(q4) + 0.438007*cos(q2)*cos(q3)*cos(q4)*cos(q5) - 0.438007*cos(q2)*cos(q3)*sin(q4)*sin(q5) - 0.438007*cos(q2)*cos(q4)*sin(q3)*sin(q5) - 0.438007*cos(q2)*cos(q5)*sin(q3)*sin(q4) - 0.438007*cos(q3)*cos(q4)*sin(q2)*sin(q5) - 0.438007*cos(q3)*cos(q5)*sin(q2)*sin(q4) - 0.438007*cos(q4)*cos(q5)*sin(q2)*sin(q3) + 0.438007*sin(q2)*sin(q3)*sin(q4)*sin(q5) + 17.4116, 1.6202*cos(q2 + q3 + q4) + 0.438007*cos(q3 + q4 + q5) + 0.438007*cos(q2 + q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.876015*cos(q5) + 1.66414, 0.97335*cos(q5)*(0.45*cos(q2 + q3 + q4) + 0.45*cos(q3 + q4) + 0.45) - 0.438007*sin(q5)*(sin(q2 + q3 + q4) + sin(q3 + q4)) + 0.292005];...
% [                                                                                                                                                                                                                                                                                                                                                                                                                                                            1.6202*cos(q2 + q3 + q4) + 0.876015*cos(q3 + q4 + q5) + 0.438007*cos(q2 + q3 + q4 + q5) + 11.8106*cos(q2 + q3) + 3.2404*cos(q3 + q4) + 14.9192*cos(q2) + 23.6212*cos(q3) + 0.876015*cos(q5) + 32.0828,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0.876015*cos(q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 23.6212*cos(q3) + 0.876015*cos(q5) + 32.0828,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0.438007*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 11.8106*cos(q3) + 0.876015*cos(q5) + 17.4116,                                                                                                                                                                                                                                  0.438007*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.876015*cos(q5) + 1.66414,                                                                             0.438007*cos(q3 + q4 + q5) + 0.438007*cos(q5) + 0.292005];...
% [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1.6202*cos(q2 + q3 + q4) + 0.438007*cos(q3 + q4 + q5)  + 0.438007*cos(q2 + q3 + q4 + q5) + 11.8106*cos(q2 + q3) + 1.6202*cos(q3 + q4) + 11.8106*cos(q3) + 0.876015*cos(q5) + 17.4116,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0.438007*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 11.8106*cos(q3) + 0.876015*cos(q5) + 17.4116,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0.876015*cos(q5) + 17.4116,                                                                                                                                                                                                                                                             0.876015*cos(q5) + 1.66415,                                                                                                          0.438008*cos(q5) + 0.292005];...
% [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1.6202*cos(q2 + q3 + q4) + 0.438007*cos(q3 + q4 + q5) + 0.438007*cos(q2 + q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.876015*cos(q5) + 1.66415,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0.438007*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.876015*cos(q5) + 1.66415,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0.876015*cos(q5) + 1.66415,                                                                                                                                                                                                                                                             0.876015*cos(q5) + 1.66415,                                                                                                          0.438008*cos(q5) + 0.292005];...
% [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.438008*cos(q5) + cos(q2)*(0.438007*cos(q4 + q5)*cos(q3) - 0.438007*sin(q4 + q5)*sin(q3)) - 1.0*sin(q2)*(0.438007*cos(q4 + q5)*sin(q3) + 0.438007*sin(q4 + q5)*cos(q3)) + 0.438007*cos(q4 + q5)*cos(q3) - 0.438007*sin(q4 + q5)*sin(q3) + 0.292005,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.438007*cos(q3 + q4 + q5) + 0.438008*cos(q5) + 0.292005,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.438008*cos(q5) + 0.292005,                                                                                                                                                                                                                                                                                    0.438008*cos(q5) + 0.292005,                                                                                                                             0.292005]];

M = [[ 3.2404*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 23.621*cos(q2 + q3) + 3.2404*cos(q3 + q4) + 29.838*cos(q2) + 23.621*cos(q3) + 0.87602*cos(q5) + 48.038, 1.6202*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 11.811*cos(q2 + q3) + 3.2404*cos(q3 + q4) + 14.919*cos(q2) + 23.621*cos(q3) + 0.87602*cos(q5) + 32.083, 1.6202*cos(q2 + q3 + q4) + 0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 11.811*cos(q2 + q3) + 1.6202*cos(q3 + q4) + 11.811*cos(q3) + 0.87602*cos(q5) + 17.412, 1.6202*cos(q2 + q3 + q4) + 0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.87602*cos(q5) + 1.6641, 0.97335*cos(q5)*(0.45*cos(q2 + q3 + q4) + 0.45*cos(q3 + q4) + 0.45) - 0.43801*sin(q5)*(sin(q2 + q3 + q4) + sin(q3 + q4)) + 0.29201];
[ 1.6202*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 11.811*cos(q2 + q3) + 3.2404*cos(q3 + q4) + 14.919*cos(q2) + 23.621*cos(q3) + 0.87602*cos(q5) + 32.083,                                                                                                    0.87602*cos(q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 23.621*cos(q3) + 0.87602*cos(q5) + 32.083,                                                                                   0.43801*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 11.811*cos(q3) + 0.87602*cos(q5) + 17.412,                                                             0.43801*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.87602*cos(q5) + 1.6641,                                                                              0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q5) + 0.29201];
[                  1.6202*cos(q2 + q3 + q4) + 0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 11.811*cos(q2 + q3) + 1.6202*cos(q3 + q4) + 11.811*cos(q3) + 0.87602*cos(q5) + 17.412,                                                                                                    0.43801*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 11.811*cos(q3) + 0.87602*cos(q5) + 17.412,                                                                                                                                                      0.87602*cos(q5) + 17.412,                                                                                                               0.87602*cos(q5) + 1.6642,                                                                                                          0.43801*cos(q5) + 0.29201];
[                                                         1.6202*cos(q2 + q3 + q4) + 0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.87602*cos(q5) + 1.6642,                                                                                                                     0.43801*cos(q3 + q4 + q5) + 1.6202*cos(q3 + q4) + 0.87602*cos(q5) + 1.6642,                                                                                                                                                      0.87602*cos(q5) + 1.6642,                                                                                                               0.87602*cos(q5) + 1.6642,                                                                                                          0.43801*cos(q5) + 0.29201];
[                                                                                                         0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q2 + q3 + q4 + q5) + 0.43801*cos(q5) + 0.29201,                                                                                                                                          0.43801*cos(q3 + q4 + q5) + 0.43801*cos(q5) + 0.29201,                                                                                                                                                     0.43801*cos(q5) + 0.29201,                                                                                                              0.43801*cos(q5) + 0.29201,                                                                                                                            0.29201]];




M_big = [[   6.4808*cos(q2 + q3 + q4) + 1.752*cos(q3 + q4 + q5) + 1.752*cos(q2 + q3 + q4 + q5) + 47.242*cos(q2 + q3) + 6.4808*cos(q3 + q4) + 59.676*cos(q2) + 47.242*cos(q3) + 1.752*cos(q5) + 96.076, 3.2404*cos(q2 + q3 + q4) + 1.752*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 23.622*cos(q2 + q3) + 6.4808*cos(q3 + q4) + 29.838*cos(q2) + 47.242*cos(q3) + 1.752*cos(q5) + 64.166, 3.2404*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 23.622*cos(q2 + q3) + 3.2404*cos(q3 + q4) + 23.622*cos(q3) + 1.752*cos(q5) + 34.824, 3.2404*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 1.752*cos(q5) + 3.3282, 1.9467*cos(q5)*(0.45*cos(q2 + q3 + q4) + 0.45*cos(q3 + q4) + 0.45) - 0.87602*sin(q5)*(sin(q2 + q3 + q4) + sin(q3 + q4)) + 0.58402];
[ 3.2404*cos(q2 + q3 + q4) + 1.752*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 23.622*cos(q2 + q3) + 6.4808*cos(q3 + q4) + 29.838*cos(q2) + 47.242*cos(q3) + 1.752*cos(q5) + 64.166,                                                                                                    1.752*cos(q3 + q4 + q5) + 6.4808*cos(q3 + q4) + 47.242*cos(q3) + 1.752*cos(q5) + 64.166,                                                                                   0.87602*cos(q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 23.622*cos(q3) + 1.752*cos(q5) + 34.824,                                                             0.87602*cos(q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 1.752*cos(q5) + 3.3282,                                                                             0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q5) + 0.58402];
[                3.2404*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 23.622*cos(q2 + q3) + 3.2404*cos(q3 + q4) + 23.622*cos(q3) + 1.752*cos(q5) + 34.824,                                                                                                  0.87602*cos(q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 23.622*cos(q3) + 1.752*cos(q5) + 34.824,                                                                                                                                                      1.752*cos(q5) + 34.824,                                                                                                               1.752*cos(q5) + 3.3284,                                                                                                         0.87602*cos(q5) + 0.58402];
[                                                       3.2404*cos(q2 + q3 + q4) + 0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 1.752*cos(q5) + 3.3284,                                                                                                                   0.87602*cos(q3 + q4 + q5) + 3.2404*cos(q3 + q4) + 1.752*cos(q5) + 3.3284,                                                                                                                                                      1.752*cos(q5) + 3.3284,                                                                                                               1.752*cos(q5) + 3.3284,                                                                                                         0.87602*cos(q5) + 0.58402];
[                                                                                                     0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q2 + q3 + q4 + q5) + 0.87602*cos(q5) + 0.58402,                                                                                                                                      0.87602*cos(q3 + q4 + q5) + 0.87602*cos(q5) + 0.58402,                                                                                                                                                   0.87602*cos(q5) + 0.58402,                                                                                                            0.87602*cos(q5) + 0.58402,                                                                                                                           0.58402]];

